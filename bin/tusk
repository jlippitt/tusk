#!/usr/bin/php
<?php

require_once(__DIR__ . '/../vendor/autoload.php');

use Tusk\Environment;
use Tusk\Expectation;
use Tusk\Spec;
use Tusk\Suite;

function describe($description, \Closure $body)
{
    $env = Environment::getInstance();

    $suite = new Suite($description, $env->getContext());

    $env->setContext($suite);

    $body();

    $env->setContext($suite->getParent());
}

function it($description, \Closure $body)
{
    $env = Environment::getInstance();

    $suite = new Spec($description, $env->getContext());

    $env->setContext($suite);

    $body();

    $env->setContext($suite->getParent());
}

function expect($value)
{
    $env = Environment::getInstance();

    return new Expectation($value, $env->getContext());
}

if ($argc !== 2) {
    die("Syntax: tusk <filename>\n");
}

require($argv[1]);

echo "All specs passed\n";
